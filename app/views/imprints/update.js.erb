if (window.calendarMatcher != undefined) {
  <%# Updating from calendar view modal %>

  <% if session[:show_machines].try(:keys).try(:include?, @imprint.machine_id.to_s) %>
    changeEventColor(window.calendarMatcher, "<%= @imprint.event_id %>", "<%= @imprint.calendar_color %>");
  <% else %>
    $(window.calendarMatcher).fullCalendar('removeEvents', <%= @imprint.event_id %>);
  <% end %>
}
else {
  <%# Updating (changing group) from orders/show %>

  <% if @imprint.valid? %>
    $('#imprint-<%= @imprint.id %>').html(
        "<%= js_train_entry(@imprint) do %>
            <% if @imprint.part_of_group? %>
              <%= render 'orders/imprint_part_of_group', imprint: @imprint %>
            <% else %>
              <%= render 'shared/imprint_details', object: @imprint %>
            <% end -%>
          <% end -%>"
    );
    $('#imprint-group-<%= imprint_group.id %>').html(
      "<%=j render 'orders/imprint_group', imprint_group: imprint_group %>"
    );

    initializeDraggableImprints();
  <% else %>
    $('#contentModal .modal-title').html("<%=j @imprint.full_name %> errors");
    $('#contentModal .modal-body').html("<%=j @imprint.errors.full_messages.join(', ') %>");
    $('#contentModal').modal('show');
    $('#contentModalSaveChanges').hide();
  <% end %>
}
